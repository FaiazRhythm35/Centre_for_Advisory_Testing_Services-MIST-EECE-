{% extends 'base.html' %}
{% load static %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/auth.css' %}">
{% endblock %}
{% block content %}
<main class="page-auth">
  <section class="auth-hero" style="background-image:url('https://picsum.photos/1600/900?random=44');"></section>
  <div class="auth-card">
    <div class="auth-brand">
      <h2 class="auth-title">Set a new password</h2>
      <p class="auth-sub">Enter your new password twice to confirm.</p>
    </div>

    {% if validlink %}
      <form method="post" class="auth-form">
        {% csrf_token %}
        {{ form.non_field_errors }}

        <label for="id_new_password1">New password</label>
        <div class="input-with-toggle">
          <input type="password" name="new_password1" id="id_new_password1" autocomplete="new-password" required>
          <button type="button" class="toggle-pass" data-target="id_new_password1">Show</button>
        </div>
        {% if form.new_password1.errors %}
          <div class="field-error">{{ form.new_password1.errors|striptags }}</div>
        {% endif %}

        <label for="id_new_password2">Confirm new password</label>
        <div class="input-with-toggle">
          <input type="password" name="new_password2" id="id_new_password2" autocomplete="new-password" required>
          <button type="button" class="toggle-pass" data-target="id_new_password2">Show</button>
        </div>
        {% if form.new_password2.errors %}
          <div class="field-error">{{ form.new_password2.errors|striptags }}</div>
        {% endif %}

        <div class="auth-actions">
          <button type="submit" class="btn btn-primary">Reset password</button>
        </div>
      </form>
    {% else %}
      <p class="auth-sub">This reset link is invalid or expired. Please request a new one.</p>
      <div class="auth-actions">
        <a class="btn btn-primary" href="{% url 'password_reset' %}">Request new link</a>
      </div>
    {% endif %}
  </div>
</main>
{% endblock %}